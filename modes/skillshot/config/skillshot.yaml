#config_version=6

mode:
  start_events: start_mode_skillshot
  stop_events:
    - skill_success
    - super_skill_success
    - skill_failed
    - stop_mode_skillshot
  priority: 500

shots:
  skill_l:
    switch: s_dragon_lane_left
    profile: skillshots_profile
    advance_events: mode_skillshot_started        # replace "skill_shot" with your mode name
  skill_r:
    switch: s_dragon_lane_right
    profile: skillshots_profile
  super_skill_target:
    switch: s_newton_ball_target
    profile: skillshots_profile

shot_groups:
  skillshots:
    shots: skill_l, skill_r
    enable_events: enable_skill
    disable_events: enable_super_skill, skill_failed
    rotate_left_events: s_flipper_left_active
    rotate_right_events: s_flipper_right_active
  super_skillshot:
    shots: super_skill_target
    enable_events: enable_super_skill
    disable_events: enable_skill, skill_failed

shot_profiles:
  skillshots_profile:
    states:
      - name: unlit
      - name: flashing
      - name: lit
    loop: true

variable_player:
  skill_success:
    score: 10_000
  super_skill_success:
    score: 100_000

event_player:
  mode_skillshot_started: enable_skill
  s_flipper_left_active{device.switches.s_plunger_lane.state == 1}: enable_super_skill
  s_flipper_left_inactive{device.switches.s_plunger_lane.state == 1}: enable_skill  

timers:
  skillshots_timeout:
    start_value: 0
    end_value: 20     # set the timeout of your skill shot here
    direction: up
    tick_interval: 1s
    start_running: false
    control_events:
      - action: start
        event: balldevice_bd_plunger_ball_eject_success
      - action: stop
        event: skill_failed
      - action: stop
        event: skill_success
      - action: stop
        event: super_skill_success

state_machines:
  skillshots_success:
    debug: true
    states:
      start:
        label: Skill shots ready
      skill_success:
        label: Skill successful
        events_when_started: skill_success
      super_skill_success:
        label: Super skill successful
        events_when_started: super_skill_success
      failed:
        label: Skill failed
        events_when_started: skill_failed
    transitions:
      - source: start
        target: skill_success
        events: skillshots_flashing_hit
      - source: start
        target: super_skill_success
        events: super_skillshot_hit
      - source: start
        target: failed
        events: skillshots_unlit_hit, timer_skillshots_timeout_complete, s_spinner_right_active,  s_ramp_right_active, s_ramp_left_active, s_temple_out_active, s_blue_target_left_active, s_blue_target_right_active, s_red_target_1_active, s_red_target_2_active, s_red_target_3_active, s_red_target_4_active, s_red_target_5_active, s_red_target_6_active, s_kickout_active, s_scoop_1_active
